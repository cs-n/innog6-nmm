<!DOCTYPE html>
<html>
<head>
<title>snmp.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<!-- Local Page style -->
<style scoped>
h1 {
  color: #4e8fc7;
}
h2 {
    color: #455a64;
    color: #f97c28;
}
img {
    float: left;
    margin-left: -40px;
}
pre {
    margin: -33px 50px 0px;
    width: 810px;
    float: right;
}
pre > code {
    background-color: #f8f8f8;
    color: #4d4d4c;
}
</style>
<!--
_class: lead
_footer: '' 
_paginate: false
-->
<!-- End Local Page style-->
<!-- Slide starts -->
<br />
<!-- ![bg vertical 50%](../images/smokeping-logo.png) -->
<h1 id="fit----network-monitoring-and-management"><!-- fit --> Network Monitoring and Management</h1>
<br />
<br />
<h3 id="introduction-to">Introduction to</h3>
<h2 id="snmp">SNMP</h2>
<br />
<h3 id="innog-6">INNOG 6</h3>
<p>March 22 - 25, 2023</p>
<p><a href="http://creativecommons.org/licenses/by-nc/4.0/"><img src="../images/cc-license.png" alt="Creative Commons License"></a></p>
<pre class="hljs"><code><div>This material is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License (http://creativecommons.org/licenses/by-nc/4.0/)
</div></code></pre>
<hr>
<h2 id="whate-is-snmp">Whate is SNMP?</h2>
<ul>
<li>Simple Network Management Protocol (SNMP)
<ul>
<li>Structured protocol, structured information</li>
<li>For querying network device state and receiving notifications</li>
<li>Also can be used to change state</li>
<li>Industry standard, hundreds of tools exist that use it</li>
<li>Supported on any decent network equipment</li>
<li>Transport : UDP ports 161 and 162 (notifications)</li>
</ul>
</li>
</ul>
<hr>
<h2 id="uses-for-snmp">Uses for SNMP</h2>
<ul>
<li>Typical queries
<ul>
<li>Bytes In/Out on an interface, errors</li>
<li>CPU load</li>
<li>Uptime</li>
<li>Temperature</li>
<li>…</li>
</ul>
</li>
<li>For hosts (servers or workstations)
<ul>
<li>Disk space</li>
<li>Installed software</li>
<li>Running processes</li>
<li>...</li>
</ul>
</li>
</ul>
<hr>
<style scoped>
ul,p {
    font-size: 80%;
}
</style>
<h2 id="snmp-versions">SNMP Versions</h2>
<ul>
<li>v1 (1988) Original specification
<ul>
<li>Historic</li>
</ul>
</li>
<li>v2 (1996) Failed Standard
<ul>
<li>Security + new data types + new operators</li>
<li>64-bit counters, get-bulk, v2 notifications</li>
<li>View-based access control model (VACM) introduced</li>
<li>Historic, no current implementations left</li>
</ul>
</li>
<li>v2c (1996) De facto standard
<ul>
<li>v2 data types and operators</li>
<li>v1 security (community string) (simple security model)</li>
<li>Historic</li>
</ul>
</li>
<li>v3 (1998) Robust security
<ul>
<li>User/view based security (USM/VACM)</li>
<li>Full Internet Standard</li>
</ul>
</li>
</ul>
<p>We will use SNMP v2c and v3 in this class</p>
<hr>
<style scoped>
ul {
    font-size: 90%;
}
p {
    font-size: 90%;
}
</style>
<h2 id="snmp-roles">SNMP roles</h2>
<p>Terminology - We will be using Manager and Agent</p>
<ul>
<li>Manager (the monitoring station)
<ul>
<li>Sometimes known as the SNMP client</li>
<li>SNMPv3 calls it the Command Generator and Notification Receiver</li>
</ul>
</li>
<li>Agent (running on the equipment/server)
<ul>
<li>Sometimes known as the SNMP server</li>
<li>SNMPv3 calls it the Command Responder and Notification Originator</li>
<li>Windows and UNIX have SNMP agents</li>
</ul>
</li>
</ul>
<hr>
<style scoped>
img {
    width: 100%;
}
</style>
<h2 id="fit---how-snmp-works-query--response"><!--fit--> How SNMP works: Query / Response</h2>
<p><img src="../images/snmp-query-response.png" alt="SNMP Query / Response"></p>
<hr>
<style scoped>
img {
    width: 100%;
    margin-top: 80px;
}
</style>
<h2 id="fit---how-snmp-works-trap--inform"><!--fit--> How SNMP works: Trap / Inform</h2>
<p><img src="../images/snmp-trap-inform.png" alt="SNMP Trap / Inform"></p>
<hr>
<style scoped>
ul {
    font-size: 90%;
}
p {
    font-size: 90%;
}
</style>
<h2 id="how-snmp-works">How SNMP works</h2>
<p>Basic operators:</p>
<ul>
<li><strong>get</strong> (manager -&gt; agent)
<ul>
<li>Query for a value</li>
</ul>
</li>
<li><strong>getnext</strong> (manager -&gt; agent)
<ul>
<li>Get next value (e.g. list of values for a table)</li>
</ul>
</li>
<li><strong>getresponse</strong> (agent -&gt; manager)
<ul>
<li>Response to get, getnext, or set, includes error returns</li>
</ul>
</li>
<li><strong>set</strong> (manager -&gt; agent)
<ul>
<li>Set a value, or perform an action</li>
</ul>
</li>
<li><strong>trap</strong> (agent -&gt; manager)
<ul>
<li>Spontaneous notification from equipment (line down, temperature above threshold, ...)</li>
</ul>
</li>
</ul>
<hr>
<style scoped>
ul {
    font-size: 96%;
}
</style>
<h2 id="how-snmp-works-contd">How SNMP works (Contd.)</h2>
<ul>
<li>Query/response based
<ul>
<li>Monitoring generally uses <strong>get</strong>, <strong>getnext</strong>, <strong>getbulk</strong></li>
<li>Changing state uses <strong>set</strong></li>
<li>Response is always a <strong>getresponse</strong></li>
<li><strong>getbulk</strong> requires v2c or v3</li>
</ul>
</li>
<li>Notifications are delivered as <strong>traps</strong> or <strong>informs</strong>
<ul>
<li><strong>traps</strong> are unacknowledged</li>
<li><strong>informs</strong> are acknowledged (v2c, v3)</li>
<li>Use v2c format <strong>traps</strong></li>
<li>No one uses <strong>informs</strong></li>
</ul>
</li>
</ul>
<hr>
<h2 id="snmp-traps">SNMP TRAPS</h2>
<ul>
<li>A way for an Agent to notify the Manager without getting a Query from the Manager</li>
<li>Agent is configured to send TRAP messages when an event occurs
<ul>
<li><em>coldStart</em></li>
<li><em>warmStart</em></li>
<li><em>ifDown</em></li>
<li><em>authenticationFailure</em></li>
</ul>
</li>
<li>After the manager receives the TRAP message, it can take further action if necessary</li>
</ul>
<hr>
<h2 id="snmp-database">SNMP database</h2>
<ul>
<li>The information offered by a device is available in its Management Information Base (MIB)
<ul>
<li>SNMP uses Object Identifiers (OIDs) to organize this information</li>
<li>OIDs are keys to identifying each piece of data</li>
<li>OIDs are organized into a tree structure that is the MIB</li>
<li>MIB files document parts of the MIB on a device</li>
</ul>
</li>
</ul>
<hr>
<h2 id="oids">OIDs</h2>
<p>OID: Object Identifier</p>
<ul>
<li>A unique key to select a particular item of data in the device</li>
<li>The same piece of information is always found at the same OID. That's simple!</li>
<li>An OID is a variable-length string of numbers, e.g.
<ul>
<li>.1.3.6.1.2.1.1.3</li>
</ul>
</li>
<li>Allocated hierarchically in a tree to ensure uniqueness (similar to DNS)</li>
</ul>
<hr>
<style scoped>
img {
    width: 135%;
    margin: -20px -50px;
}
</style>
<h2 id="the-mib-tree">The MIB Tree</h2>
<p><img src="../images/Mib_tree_example.png" alt="SNMP MIB Tree">
<img src="../images/cisco-mib-tree.jpg" alt="bg right 95%"></p>
<hr>
<h2 id="interesting-parts-of-the-mib-tree">Interesting parts of the MIB tree</h2>
<p>The Internet MIB, <strong>.1.3.6.1</strong>, really only two branches of interest:</p>
<ul>
<li>Standard MIBs
<ul>
<li><strong>.1.3.6.1.2.1 = .iso.org.dod.internet.mgmt.mib-2</strong></li>
</ul>
</li>
<li>Vendor-specific (proprietary) MIBs
<ul>
<li><strong>.1.3.6.1.4.1 = .iso.org.dod.internet.private.enterprises</strong></li>
</ul>
</li>
</ul>
<hr>
<h2 id="oids-and-mib-files">OIDs and MIB files</h2>
<p>Read from left to right</p>
<ul>
<li>OID components separated by '.'
<ul>
<li>.1.3.6.1.4.1.9. ...</li>
</ul>
</li>
<li>Each OID corresponds to a label
<ul>
<li>.1.3.6.1.2.1.1.5 =&gt; sysName</li>
</ul>
</li>
<li>The complete path:
<ul>
<li>.iso.org.dod.internet.mgmt.mib2.system.sysName</li>
</ul>
</li>
<li>How do we convert from OIDs to Labels (and vice versa)?
<ul>
<li>Use the MIBs files!</li>
</ul>
</li>
</ul>
<hr>
<h2 id="mib-files">MIB Files</h2>
<ul>
<li>MIB files define the objects that can be queried, including:
<ul>
<li>Object name</li>
<li>Object description</li>
<li>Data type (integer, text, list)</li>
</ul>
</li>
<li>MIB files are structured text
<ul>
<li>using an ASN.1 subset called the Structure of Management Information (SMI)</li>
</ul>
</li>
<li>Standard MIB files include:
<ul>
<li>MIB-II - (RFC1213) - a sub-group of MIBs</li>
<li>HOST-RESOURCES-MIB (RFC2790)</li>
</ul>
</li>
</ul>
<hr>
<h2 id="mib-sample">MIB Sample</h2>
<pre class="hljs"><code><div>sysUpTime OBJECT-TYPE
          SYNTAX TimeTicks
          ACCESS read-only
          STATUS mandatory
          DESCRIPTION
          &quot;The time (in hundredths of a second)
since the network management portion of the system
was last reinitialized.&quot;
          ::= { system 3 }
</div></code></pre>
<hr>
<style scoped>
ul {
    font-size: 80%;
}
</style>
<h2 id="mib-sample-contd">MIB Sample (Contd.)</h2>
<ul>
<li><strong>sysUpTime OBJECT-TYPE</strong>
<ul>
<li>This defines the object called <em><strong>sysUpTime</strong></em>.</li>
</ul>
</li>
<li><strong>SYNTAX TimeTicks</strong>
<ul>
<li>This object is of the type <em><strong>TimeTicks</strong></em>. Object types are specified in the SMI we mentioned a moment ago.</li>
</ul>
</li>
<li><strong>ACCESS read-only</strong>
<ul>
<li>This object can only be read via SNMP (i.e. <strong>get</strong>, <strong>getnext</strong>); it cannot be changed (i.e. <strong>set</strong>).</li>
</ul>
</li>
<li><strong>STATUS mandatory</strong>
<ul>
<li>This object must be implemented in any SNMP agent.</li>
</ul>
</li>
<li><strong>DESCRIPTION</strong>
<ul>
<li>A description of the object</li>
</ul>
</li>
<li><strong>::= { system 3 }</strong>
<ul>
<li>The <em><strong>sysUpTime</strong></em> object is the third branch off of the <em><strong>system</strong></em> object group tree.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="mib-files-contd">MIB Files (Contd.)</h2>
<ul>
<li>MIB files also make it possible to interpret a returned value from an agent
<ul>
<li>For example, the status for a fan could be:
<ul>
<li>1, 2, 3, 4, 5, or 6</li>
<li>What does it mean?</li>
</ul>
</li>
</ul>
</li>
<li>Look for the Textual Convention (tc) in the MIB</li>
</ul>
<hr>
<h2 id="mib-sample">MIB Sample</h2>
<pre class="hljs"><code><div>CiscoEnvMonState ::= TEXTUAL-CONVENTION
        STATUS current
        DESCRIPTION
           &quot;Represents the state of a device being monitored.
            Valid values are:
            normal(1):         the environment is good, such as low
                               temperature.
            warning(2):        the environment is bad, such as temperature
                               above normal operation range but not too
                               high.
            critical(3):       the environment is very bad, such as
                               temperature much higher than normal
                               operation limit.
            shutdown(4):       the environment is the worst, the system
                               should be shutdown immediately.
            notPresent(5):     the environmental monitor is not present,
                               such as temperature sensors do not exist.
            notFunctioning(6): the environmental monitor does not
                               function properly, such as a temperature
                               sensor generates a abnormal data like
                               1000 C.
</div></code></pre>
<hr>
<style scoped>
ul {
    font-size: 85%;
}
</style>
<h2 id="snmp-and-security">SNMP and Security</h2>
<ul>
<li>SNMP versions 1 and 2c are insecure</li>
<li>SNMP version 3 was created to fix this</li>
<li>SNMPv3 authentication is based on a “User-based Security Model” (USM):
<ul>
<li>Authenticity and integrity</li>
<li>Keys are used for users, and messages have digital signatures generated with a hash function (MD5 or SHA)</li>
<li>Privacy</li>
<li>Messages can be encrypted with secret-key (private) algorithms (DES or AES)</li>
<li>Temporary validity</li>
<li>Utilizes a synchronized clock with a 150 second window with sequence checking</li>
</ul>
</li>
</ul>
<hr>
<h2 id="snmpv3-security-levels">SNMPv3 Security Levels</h2>
<ul>
<li><strong>noAuthNoPriv</strong>
<ul>
<li>No authentication, no privacy</li>
</ul>
</li>
<li><strong>authNoPriv</strong>
<ul>
<li>Authentication with no privacy</li>
</ul>
</li>
<li><strong>authPriv</strong>
<ul>
<li>Authentication with privacy</li>
</ul>
</li>
</ul>
<hr>
<h2 id="fit---cisco-snmp-agent-configuration-ro"><!--fit--> Cisco SNMP Agent Configuration R/O</h2>
<p><strong>Read-only</strong></p>
<pre class="hljs"><code><div># snmp-server community NetManage RO
</div></code></pre>
<ul>
<li>Enables SNMPv1 and v2c</li>
</ul>
<pre class="hljs"><code><div># snmp-server group ReadGroup v3 auth
# snmp-server user admin ReadGroup v3 auth sha NetManage
</div></code></pre>
<ul>
<li>SNMPv3 authentication, no encryption</li>
</ul>
<hr>
<h2 id="fit---cisco-snmp-agent-configuration-rw"><!--fit--> Cisco SNMP Agent Configuration R/W</h2>
<p><strong>Read-write</strong></p>
<pre class="hljs"><code><div># snmp-server group WriteGroup v3 auth write v1default
# snmp-server user admin-rw WriteGroup v3 
  auth sha NetManage priv aes 128 NetWrite
</div></code></pre>
<ul>
<li>Cisco allows authNoPriv and authPriv queries with this user</li>
<li>You could also define a read-write user without encryption (priv)</li>
<li>Note that we recommend using SNMP version 3 if you want write access using the set operator</li>
</ul>
<hr>
<h2 id="net-snmp-agent-snmpd">Net-SNMP Agent (snmpd)</h2>
<ul>
<li>Add a community string by editing <code>/etc/snmp/snmpd.conf</code> and adding:</li>
</ul>
<pre class="hljs"><code><div>rocommunity NetManage 100.64.0.0/16
</div></code></pre>
<ul>
<li>Add the SNMPv3 user</li>
</ul>
<pre class="hljs"><code><div># systemctl stop snmpd
# net-snmp-create-v3-user –X DES -a NetManage admin
# systemctl start snmpd
</div></code></pre>
<hr>
<style scoped>
p {
    font-size: 80%;
}
</style>
<h2 id="querying-an-snmp-agent">Querying an SNMP agent</h2>
<p>Using Net-SNMP command line tools...</p>
<ul>
<li>Some typical commands for querying:
<ul>
<li><strong>snmpget</strong></li>
<li><strong>snmpwalk</strong></li>
<li><strong>snmpbulkwalk</strong> (requires v2c or v3)</li>
<li><strong>snmpstatus</strong></li>
<li><strong>snmptable</strong></li>
</ul>
</li>
<li>All commands have same authentication options:
<ul>
<li><code>snmpXXX -v1 -c&lt;community&gt; host [OID]</code></li>
<li><code>snmpXXX -v2c -c&lt;community&gt; host [OID]</code></li>
<li><code>snmpXXX -v3 -lauthNoPriv -u&lt;user&gt; -X DES -a&lt;pass&gt; host [OID]&gt;</code></li>
</ul>
</li>
</ul>
<hr>
<h2 id="fit---querying-an-snmp-agent-aka-server"><!--fit--> Querying an SNMP agent (aka server)</h2>
<p>Let's look at some examples</p>
<pre class="hljs"><code><div>$ snmpstatus -v2c -c NetManage 100.68.Y.1
$ snmpget -v2c -c NetManage 100.68.Y.1 ifNumber.0
$ snmpwalk -v2c -c NetManage 100.68.Y.1 ifDescr
</div></code></pre>
<p>“Y” == your campus number</p>
<hr>
<h2 id="querying-an-snmp-agent">Querying an SNMP agent</h2>
<ul>
<li>
<p>OID</p>
<ul>
<li>
<p>A value, for example, .1.3.6.1.2.1.1.5.0</p>
</li>
<li>
<p>or its name equivalent: sysName.0</p>
</li>
<li>
<p>For example:</p>
<pre class="hljs"><code><div>$ snmpget -v2c -c NetManage localhost .1.3.6.1.2.1.1.5.0
$ snmpget -v2c -c NetManage localhost sysName.0
$ snmpget -v2c -c NetManage localhost sysName
</div></code></pre>
</li>
</ul>
</li>
<li>
<p>Let's ask for the system's name (using the OID above)</p>
<ul>
<li>Why the .0? What do you notice?</li>
</ul>
</li>
</ul>
<hr>
<style scoped>
ul {
    font-size: 85%;
}
</style>
<h2 id="failed-querywhy">Failed Query...Why?</h2>
<ul>
<li>
<p>Two gets:</p>
<pre class="hljs"><code><div># snmpget -v1 -c NetManage 100.68.1.1 ifHCInOctets.1
Error in packet
Reason: (noSuchName) There is no such variable name in this MIB.
Failed object: IF-MIB::ifHCInOctets.1

# snmpget -v2c -c NetManage 100.68.1.1 ifHCInOctets.1
IF-MIB::ifHCInOctets.1 = Counter64: 144058265
</div></code></pre>
</li>
<li>
<p>Why? Notice the data type: Counter64. 64-bit counters are only supported in SNMPv2c and v3.</p>
</li>
<li>
<p>64-bit counters are important because 32-bit interface counters (ifInOctets) can wrap in 34 seconds on Gig interfaces. (How fast can it wrap on 10G?)</p>
</li>
</ul>
<hr>
<h2 id="snmp-failure-no-response">SNMP failure: no response?</h2>
<ul>
<li>The device might be offline or unreachable</li>
<li>The device might not be running an SNMP agent</li>
<li>The device might be configured with a different community string</li>
<li>The device might be configured to refuse SNMP queries from your IP address</li>
</ul>
<p>In all of these cases you will get no response</p>
<hr>
<style scoped>
ul {
    font-size: 85%;
}
</style>
<h2 id="snmp-best-practices">SNMP Best Practices</h2>
<ul>
<li>Secure your SNMP access and traffic:
<ul>
<li>Management VLAN</li>
<li>Access lists</li>
<li>Use SNMPv3 with authentication for queries and sets where possible</li>
</ul>
</li>
<li>Use SNMPv2c traps
<ul>
<li>Better formatted than v1 traps</li>
<li>Accurate timestamps</li>
</ul>
</li>
<li>Do no harm
<ul>
<li>Only poll as fast as you really need</li>
<li>Possible to drive CPU load on devices up and affect other protocol processing</li>
<li>It does no good to poll every 5 seconds if the device updates the counter every 10</li>
</ul>
</li>
</ul>
<hr>
<style scoped>
ul,p {
    font-size: 66%;
}
</style>
<h2 id="references">References</h2>
<ul>
<li>Essential SNMP (O’Reilly Books) by Douglas Mauro, Kevin Schmidt
<a href="http://www.amazon.com/Essential-Second-Edition-Douglas-Mauro/dp/0596008406">http://www.amazon.com/Essential-Second-Edition-Douglas-Mauro/dp/0596008406</a></li>
<li>Wikipedia
<a href="http://en.wikipedia.org/wiki/Simple_Network_Management_Protocol">http://en.wikipedia.org/wiki/Simple_Network_Management_Protocol</a></li>
<li>MIB/OID Browser
<a href="http://oid-info.com/">http://oid-info.com/</a></li>
<li>Cisco IOS MIB Tools
<a href="https://mibs.cloudapps.cisco.com/ITDIT/MIBS/servlet/index">https://mibs.cloudapps.cisco.com/ITDIT/MIBS/servlet/index</a></li>
<li>Open Source Java MIB Browser
<a href="http://www.dwipal.com/mibbrowser.htm">http://www.dwipal.com/mibbrowser.htm</a></li>
<li>SNMP Link – collection of SNMP resources
<a href="http://www.snmplink.org/">http://www.snmplink.org/</a></li>
<li>Net-SNMP Open Source SNMP tools
<a href="http://net-snmp.sourceforge.net/">http://net-snmp.sourceforge.net/</a></li>
</ul>
<hr>
<!--
_class: lead
_paginate: false
-->
<h2 id="fit---question"><!--fit--> <img class="emoji" alt="question" src="data:image/png;base64,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" /></h2>
<!-- Slide end -->

</body>
</html>
