<!DOCTYPE html>
<html>
<head>
<title>netflow.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<!-- Local Page style -->
<style scoped>
h1 {
  color: #4e8fc7;
}
h2 {
    color: #455a64;
    color: #f97c28;
}
img {
    float: left;
    margin-left: -40px;
}
pre {
    margin: -33px 50px 0px;
    width: 810px;
    float: right;
}
pre > code {
    background-color: #f8f8f8;
    color: #4d4d4c;
}
</style>
<!--
_class: lead
_footer: '' 
_paginate: false
-->
<!-- End Local Page style-->
<!-- Slide starts -->
<br />
<!--![bg top 60%](../images/influxdata-logo.png)-->
<h1 id="fit----network-monitoring-and-management"><!-- fit --> Network Monitoring and Management</h1>
<br />
<br />
<h2 id="introduction-to-netflow">Introduction to Netflow</h2>
<h4 id="network-flow">(Network Flow)</h4>
<br />
<h3 id="innog-6">INNOG 6</h3>
<p>Dec 8 - 12, 2019</p>
<p><a href="http://creativecommons.org/licenses/by-nc/4.0/"><img src="../images/cc-license.png" alt="Creative Commons License"></a></p>
<pre class="hljs"><code><div>This material is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License (http://creativecommons.org/licenses/by-nc/4.0/)
</div></code></pre>
<hr>
<style scoped>
p {
    font-size: 75%;
}
</style>
<h2 id="what-is-a-network-flow">What is a Network Flow</h2>
<ul>
<li>A set of related packets</li>
<li>Packets that belong to the same transport connection. e.g.
<ul>
<li>TCP, same src IP, src port, dst IP, dst port</li>
<li>UDP, same src IP, src port, dst IP, dst port</li>
<li>Some tools consider &quot;bidirectional flows&quot;, i.e. A-&gt;B and B-&gt;A as part of the same flow</li>
</ul>
</li>
</ul>
<p><a href="http://en.wikipedia.org/wiki/Traffic_flow_(computer_networking)">http://en.wikipedia.org/wiki/Traffic_flow_(computer_networking)</a></p>
<hr>
<style scoped>
img {
    width: 98%;
    margin: -60px 40px auto;
}
</style>
<h2 id="simple-flows">Simple flows</h2>
<p><img src="../images/netflow-simple-flow.png" alt="Netflow Simple Flows"></p>
<hr>
<h2 id="cisco-ios-definition-of-a-flow">Cisco IOS Definition of a Flow</h2>
<ul>
<li>Unidirectional sequence of packets sharing:
<ul>
<li>Source IP address</li>
<li>Destination IP address</li>
<li>Source port for UDP or TCP, 0 for other protocols</li>
<li>Destination port for UDP or TCP, type and code for ICMP, or 0 for other protocols</li>
<li>IP protocol</li>
<li>Ingress interface (SNMP ifIndex)</li>
<li>IP Type of Service</li>
</ul>
</li>
</ul>
<hr>
<style scoped>
img {
    width: 98%;
    margin: -30px 10px auto;
}
</style>
<h2 id="fit---which-of-these-six-packets-are-in-the-same-flows"><!--fit--> which of these six packets are in the same flows?</h2>
<p><img src="../images/netflow-packets.png" alt="Netflow Packets"></p>
<hr>
<style scoped>
img {
    width: 98%;
    margin: -30px 10px auto;
}
</style>
<h2 id="fit---which-of-these-six-packets-are-in-the-same-flows-contd"><!--fit--> which of these six packets are in the same flows? (contd.)</h2>
<p><img src="../images/netflow-packets-match.png" alt="Netflow Packets Match"></p>
<hr>
<h2 id="uses-and-applications">Uses and Applications</h2>
<ul>
<li>You can answer questions like:
<ul>
<li>Which user / department has been uploading / downloading the most?</li>
<li>Which are the most commonly-used protocols on my network?</li>
<li>Which devices are sending the most SMTP traffic, and to where?</li>
</ul>
</li>
<li>Identification of anomalies and attacks</li>
<li>More fine-grained visualisation (graphing) than can be done at the interface level</li>
</ul>
<hr>
<h2 id="uses-for-netflow">Uses for Netflow</h2>
<ul>
<li>Problem identification / solving
<ul>
<li>Traffic classification</li>
<li>DoS Traceback</li>
</ul>
</li>
<li>Traffic Analysis and Engineering
<ul>
<li>Inter-AS traffic analysis</li>
<li>Reporting on application proxies</li>
</ul>
</li>
<li>Accounting (or billing)
<ul>
<li>Cross verification from other sources</li>
<li>Can cross-check with SNMP data</li>
</ul>
</li>
</ul>
<hr>
<h2 id="flow-accounting">Flow Accounting</h2>
<ul>
<li>A summary of all the packets seen in a flow (so far):
<ul>
<li>Flow identification: protocol, src/dst IP/port...</li>
<li>Packet count</li>
<li>Byte count</li>
<li>Start and end times</li>
<li>Maybe additional info, e.g. AS numbers, netmasks</li>
</ul>
</li>
<li>Records traffic <code>volume</code> and <code>type</code> but not <code>content</code></li>
<li>Flow based accounting can be a good supplement to SNMP based accounting.</li>
</ul>
<hr>
<style scoped>
img {
    width: 90%;
    margin: -35px 25px auto;
}
</style>
<h2 id="flow-accounting-contd">Flow Accounting (contd.)</h2>
<p><img src="../images/netflow-accounting.png" alt="Netflow accounting"></p>
<hr>
<h2 id="working-with-flows">Working with flows</h2>
<ol>
<li>Configure device (e.g. router) to generate flow accounting records</li>
<li>Export the flows from the device (router) to a collector (PC)
<ul>
<li>Configure protocol version and destination</li>
</ul>
</li>
<li>Receive the flows, write them to disk</li>
<li>Analyse the flows</li>
</ol>
<p>Many tools available, both free and commercial</p>
<hr>
<h2 id="where-to-generate-flow-records">Where to generate flow records</h2>
<ol>
<li>
<p>On a router or other network device</p>
<ul>
<li>If the device supports it</li>
<li>No additional hardware required</li>
<li>Might have some impact on performance</li>
</ul>
</li>
<li>
<p>Passive collector (usually a Unix host)</p>
<ul>
<li>Receives a copy of every packet and generates flows</li>
<li>Requires a mirror port</li>
<li>Resource intensive</li>
</ul>
</li>
</ol>
<hr>
<style scoped>
img {
    width: 95%;
    margin: -50px 40px auto;
}
</style>
<h2 id="flow-collection">Flow Collection</h2>
<p><img src="../images/netflow-collection.png" alt="Netflow Collection"></p>
<hr>
<h2 id="flow-collection-contd">Flow Collection (contd.)</h2>
<ul>
<li>All flows through router can be observed</li>
<li>Router overhead to process &amp; export flows</li>
<li>Can select which interfaces Netflow collection is needed on and not activate it on others</li>
<li>If router on each LAN, Netflow can be activated on them to reduce load on core router</li>
</ul>
<hr>
<style scoped>
img {
    width: 95%;
    margin: -10px 40px auto;
}
</style>
<h2 id="passive-monitor-collection">Passive Monitor Collection</h2>
<p><img src="../images/netflow-passive-collection.png" alt="Netflow Passive Collection"></p>
<hr>
<h2 id="passive-collector">Passive Collector</h2>
<ul>
<li>Examples
<ul>
<li>softflowd (Linux/BSD)</li>
<li>pfflowd (BSD)</li>
<li>ng_netflow (BSD)</li>
</ul>
</li>
<li>Collector sees all traffic through the network point it is connected on and generates flows</li>
<li>Relieves router from processing traffic, creating flows and exporting them</li>
<li>Useful on links:
<ul>
<li>with only one entry into the network</li>
<li>where only flows from one section of the network are needed</li>
</ul>
</li>
<li>Can be deployed in conjunction with an IDS</li>
</ul>
<hr>
<h2 id="a-thought">A thought:</h2>
<p>Your network probably already has a device
which is keeping track of IP addresses and port
numbers of traffic flowing through it.</p>
<p>What is it?</p>
<hr>
<h2 id="flow-export-protocols">Flow Export Protocols</h2>
<ul>
<li>Cisco <strong>Netflow</strong>, different versions
<ul>
<li><strong>v5</strong>: widely deployed</li>
<li><strong>v9</strong>: newer, extensible, includes IPv6 support</li>
</ul>
</li>
<li>IP Flow Information Export (<strong>IPFIX</strong>):
<ul>
<li>IETF standard, based on Netflow v9</li>
</ul>
</li>
<li><strong>sFlow</strong>: Sampling-based, commonly found on switches</li>
<li><strong>jFlow</strong>: Juniper</li>
<li>We use Netflow, but many tools support multiple protocols</li>
</ul>
<hr>
<h2 id="cisco-netflow">Cisco Netflow</h2>
<ul>
<li>Unidirectional flows</li>
<li>IPv4 unicast and multicast
<ul>
<li>(IPv6 in Netflow v9)</li>
</ul>
</li>
<li>Flows exported via UDP
<ul>
<li>Choose a port. No particular standard, although 2055 and 9996 are commonly used</li>
</ul>
</li>
<li>Supported on IOS, ASA and CatOS platforms
<ul>
<li>but with different implementations</li>
</ul>
</li>
</ul>
<hr>
<h2 id="cisco-ios-configuration">Cisco IOS Configuration</h2>
<ul>
<li>Configured on each interface
<ul>
<li>Inbound and outbound</li>
<li>Older IOS only allows input</li>
</ul>
</li>
<li>Define the version</li>
<li>Define the IP address and port of the collector (where to send the flows)</li>
<li>Optionally enable aggregation tables</li>
<li>Optionally configure flow timeout and main (v5) flow table size</li>
<li>Optionally configure sample rate</li>
</ul>
<hr>
<style scoped>
pre {
    margin: 1px auto 1px;
}
</style>
<h2 id="fit---configuring-netflow-the-old-way"><!--fit--> Configuring Netflow: the old way</h2>
<ul>
<li>
<p>Enable CEF</p>
<pre class="hljs"><code><div>ip cef
ipv6 cef
</div></code></pre>
</li>
<li>
<p>Enable flow on each interface</p>
<pre class="hljs"><code><div>ip route cache flow (pre IOS 12.4)
</div></code></pre>
<p>or</p>
<pre class="hljs"><code><div>ip flow ingress (IOS 12.4 onwards)
ip flow egress
</div></code></pre>
</li>
<li>
<p>Exporting Flows to a collector</p>
<pre class="hljs"><code><div>ip flow-export version [5|9] [origin-as|peer-as]
ip flow-export destination &lt;x.x.x.x&gt; &lt;udp-port&gt;
</div></code></pre>
</li>
</ul>
<hr>
<h2 id="%22flexible-netflow%22-the-new-way">&quot;Flexible Netflow&quot;: the new way</h2>
<ul>
<li>Only way to monitor IPv6 flows on modern IOS</li>
<li>Start using it now   - IPv6 is here</li>
<li>Many mind-boggling options available, but basic configuration is straightforward</li>
</ul>
<hr>
<style scoped>
pre {
    margin: 1px auto 1px;
}
</style>
<h2 id="flexible-netflow-configuration">Flexible Netflow Configuration</h2>
<ul>
<li>
<p>Define one or more exporters</p>
<pre class="hljs"><code><div>flow exporter EXPORTER-1
  destination 192.0.2.99
  transport udp 9996
  source Loopback0
  template data timeout 300
</div></code></pre>
</li>
<li>
<p>Define one or more flow monitors</p>
<pre class="hljs"><code><div>flow monitor FLOW-MONITOR-V4
  exporter EXPORTER-1
  cache timeout active 300
  record netflow ipv4 original-input

flow monitor FLOW-MONITOR-V6
  exporter EXPORTER-1
  cache timeout active 300
  record netflow ipv6 original-input
</div></code></pre>
</li>
</ul>
<hr>
<h2 id="flexible-netflow-configuration-contd">Flexible Netflow Configuration (contd.)</h2>
<ul>
<li>
<p>Apply flow monitors to active interface</p>
<pre class="hljs"><code><div>interface GigabitEthernet0/0/0
  ip flow monitor FLOW-MONITOR-V4 input
  ip flow monitor FLOW-MONITOR-V4 output
  ipv6 flow monitor FLOW-MONITOR-V6 input
  ipv6 flow monitor FLOW-MONITOR-V6 output
</div></code></pre>
</li>
</ul>
<hr>
<h2 id="top-talkers">Top Talkers</h2>
<ul>
<li>
<p>You can summarize flows directly on the router, e.g.</p>
<pre class="hljs"><code><div>show flow monitor FLOW-MONITOR-V4 cache aggregate ipv4 source
address ipv4 destination address sort counter bytes top 20
</div></code></pre>
</li>
<li>
<p>Yes, that's one long command!</p>
</li>
<li>
<p>Old command not available for Flexible Netflow</p>
<pre class="hljs"><code><div>show ip flow top-talkers
</div></code></pre>
</li>
<li>
<p>Make an Alias:</p>
<pre class="hljs"><code><div>conf t
alias exec top-talkers show flow..
</div></code></pre>
</li>
</ul>
<hr>
<h2 id="collecting-flows-nfdump">Collecting flows: nfdump</h2>
<ul>
<li>Free and open source   - runs on collector</li>
<li>nfcapd listens for incoming flow records and writes them to disk (flat files)
<ul>
<li>typically starts a new file every 5 minutes</li>
</ul>
</li>
<li>nfdump reads the files and turns them into human-readable output</li>
<li>nfdump has command-line options to filter and aggregate the flows</li>
</ul>
<hr>
<style scoped>
img {
    width: 100%;
    margin: -10px auto;
}
</style>
<h2 id="nfdump-architecture">NfDump Architecture</h2>
<p><img src="../images/netflow-nfdump-architecture.png" alt="Netflow NfDump Architecture"></p>
<hr>
<h2 id="analysing-flows-nfsen">Analysing flows: nfsen</h2>
<ul>
<li>Companion to nfdump</li>
<li>Web GUI</li>
<li>Creates RRD graphs of traffic totals</li>
<li>Lets you zoom in to a time of interest and do nfdump analysis</li>
<li>Manages nfcapd instances for you
<ul>
<li>Can run multiple nfcapd instances for listening to flows from multiple routers</li>
</ul>
</li>
<li>Plugins available like port tracker, surfmap</li>
</ul>
<hr>
<!--
_class: lead
_paginate: false
-->
<h2 id="fit---question"><!--fit--> <img class="emoji" alt="question" src="data:image/png;base64,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" /></h2>
<!-- Slide end -->
<hr>
<!--
_class: lead
_paginate: false
-->
<h2 id="fit---cisco-netflow-versions"><!--fit--> Cisco Netflow Versions</h2>
<hr>
<h2 id="netflow-v1">Netflow v1</h2>
<ul>
<li>Key fields: Source/Destination IP, Source/Destination Port, IP Protocol, ToS, Input interface.</li>
<li>Accounting: Packets, Octets, Start/End time, Output interface</li>
<li>Other: Bitwise OR of TCP flags.</li>
<li>Does not have sequence numbers – no way to detect lost flows</li>
<li>Obsolete</li>
</ul>
<hr>
<h2 id="netflow-v2-to-v4">Netflow v2 to v4</h2>
<ul>
<li>Cisco internal</li>
<li>Were never released</li>
</ul>
<hr>
<h2 id="netflow-v5">Netflow v5</h2>
<ul>
<li>Key fields: Source/Destination IP, Source/Destination Port, IP Protocol, ToS, Input interface.</li>
<li>Accounting: Packets, Octets, Start/End time, Output interface.</li>
<li>Other: Bitwise OR of TCP flags, Source/Destination AS and IP Mask.</li>
<li>Packet format adds sequence numbers for detecting lost exports.</li>
<li>IPv4 only</li>
</ul>
<hr>
<h2 id="netflow-v6--v7">Netflow v6 &amp; v7</h2>
<ul>
<li>Used exclusively on the Cisco Catalyst line of ethernet switches</li>
<li>Requires the Netflow Feature Card, a specialist forwarding engine for the Catalyst Switches</li>
<li>Not compatible or comparable with Netflow on Cisco routers</li>
</ul>
<hr>
<h2 id="netflow-v8">Netflow v8</h2>
<ul>
<li>Aggregated v5 flows.</li>
<li>Not all flow types available on all equipment</li>
<li>Much less data to post process, but loses fine granularity of v5 – no IP addresses.</li>
</ul>
<hr>
<h2 id="netflow-v9">Netflow v9</h2>
<ul>
<li>IPv6 support</li>
<li>32-bit ASN support</li>
<li>Additional fields like MPLS labels</li>
<li>Builds on earlier versions</li>
<li>Periodically sends &quot;template&quot; packet, all flow data fields reference the template</li>
</ul>

</body>
</html>
